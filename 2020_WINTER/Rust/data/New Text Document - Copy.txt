Reminder1: file group4_new_175.csv should be in the same file directory
Reminder2: the code will take almost 4 hours
->Date generation
generate Q
  7%|▋         | 7/100 [00:00<00:01, 69.14it/s]generate dataset
100%|██████████| 100/100 [00:01<00:00, 87.21it/s]
true loglike1: 9801.774771662398
true loglike2 403.5093261982014
->Estimation1 x0 known
[0. 0.] -11231.633403033404
[0.       0.499995] -11278.196640072725
[0.      0.99999] -11280.34034745854
[0.499995 0.      ] -11134.27315423191
[0.499995 0.499995] -11234.862700665572
[0.499995 0.99999 ] -11280.247185915776
[0.99999 0.     ] -11058.149079756766
[0.99999  0.499995] -11281.115930797676
[0.99999 0.99999] -11281.148315110016
[0.99999 0.     ] -11058.149079756766
[1.0499895 0.       ] -14655.419488675794
[9.9999e-01 2.5000e-04] -10926.512709543553
[9.499905e-01 2.500000e-04] -9978.823057691901
[8.99991e-01 3.75000e-04] -10053.085292724632
[9.499905e-01 5.000000e-04] -9942.464184498733
[9.2499075e-01 7.5000000e-04] -9957.118895522448
[8.99991e-01 5.00000e-04] -10037.117515103344
[9.2499075e-01 4.3750000e-04] -12825.44339125347
[9.499905e-01 3.750000e-04] -13432.204312304915
[9.7499025e-01 3.7500000e-04] -9968.011415301477
[9.7499025e-01 5.0000000e-04] -9953.444710833384
[9.499905e-01 6.250000e-04] -11825.83671388764
[9.68740313e-01 4.37500000e-04] -9949.440648432988
[9.43740563e-01 4.37500000e-04] -9956.008951233454
[9.67177828e-01 4.84375000e-04] -9942.627415689598
[9.48428016e-01 5.46875000e-04] -9939.085084143873
[9.38271867e-01 6.01562500e-04] -9946.291225919329
[9.31240688e-01 5.62500000e-04] -9961.30381994479
[9.58193543e-01 5.03906250e-04] -9937.749387491112
[9.56631059e-01 5.50781250e-04] -9933.469947141944
[9.59951338e-01 5.76171875e-04] -9930.581286823195
[9.69716865e-01 5.33203125e-04] -9940.46882906079
[9.53750228e-01 5.43457031e-04] -9935.43427268146
[9.55508023e-01 6.15722656e-04] -9927.994143807455
[9.54165263e-01 6.71630859e-04] -9924.024026023379
[9.60366373e-01 7.04345703e-04] -9920.085947761565
[9.63674445e-01 7.84790039e-04] -9915.298116186124
[9.57888370e-01 8.80249023e-04] -9908.510297276878
[0.95685689 0.00103229] -9900.340736581184
[0.96636607 0.00114545] -9897.54633837877
[0.97246647 0.00138235] -9896.514568354101
[0.96564891 0.00162985] -16549.626591862856
[0.96416806 0.00099606] -9903.18586934437
[0.9651553  0.00141859] -9885.679337481057
[0.96564891 0.00162985] -16549.626591862856
[0.98076488 0.00176865] -9910.479097382498
[0.96283389 0.00121638] -9892.234588982099
[0.95552271 0.00125261] -9890.562147045619
[0.95784412 0.00145482] -9882.260339259308
[0.95534924 0.00157404] -12423.091714154816
[0.96747671 0.00162079] -9881.074579681643
[0.97345371 0.00180489] -18962.88223271482
[0.96016553 0.00165703] -9875.645270280693
[0.95767065 0.00177625] -9872.02001983925
[0.96730324 0.00194222] -19739.293532605618
[0.9602089  0.00157667] -9878.189108517476
[0.95040284 0.00173212] -9876.179931656081
[0.94786459 0.0019317 ] -9872.382817298274
[0.9551324  0.00197582] -9867.067683180021
[0.95749718 0.00209767] -9863.60404660434
[0.96730324 0.00194222] -9871.946431778259
[0.96712976 0.00226365] -9864.338390115288
[0.95732371 0.0024191 ] -9856.51076237182
[0.95233394 0.00265754] -9853.191243912986
[0.94270135 0.00249156] -9864.056274947008
[0.94880846 0.00243459] -9859.697604151444
[0.94364522 0.00299445] -9853.657046229284
[0.9471707  0.00321741] -9846.959601776673
[0.94635183 0.00360882] -9842.023705329444
[0.95504055 0.00327191] -9842.21273139051
[0.94905844 0.00422318] -9832.793269920163
[0.94742068 0.005006  ] -9826.278379562878
[0.93873196 0.00534292] -9831.130160244897
[0.93980082 0.0067401 ] -9820.296959962014
[0.93652531 0.00830575] -9815.959739963071
[0.94521403 0.00796883] -9809.929485044648
[0.94845507 0.00928179] -9803.898095381288
[0.9375597  0.01258153] -9804.124217770504
[0.94948946 0.01355758] -9797.447261084968
[0.95597153 0.0161835 ] -9799.141630905691
[0.96038483 0.01025784] -9803.40239636642
[0.96141921 0.01453363] -9802.410324190381
[0.95052384 0.01783337] -9798.608499102498
[0.93859409 0.01685732] -9801.211385262322
[0.94430037 0.0162764 ] -9798.34359456888
[0.94326598 0.01200061] -9800.859860863953
[0.94870938 0.01637518] -9797.573391568782
[0.95389847 0.01365636] -9797.71019591333
[0.95149894 0.01431137] -9797.244900787486
[0.95227902 0.01149377] -9798.973261766903
[0.94960179 0.01515483] -9797.218407835042
[0.95161127 0.01590862] -9797.538024807709
[0.95001991 0.01414534] -9797.24114904032
[0.94812276 0.0149888 ] -9797.332439904385
[0.9506549  0.01448073] -9797.190930881168
[0.95023677 0.01549021] -9797.278309888628
[0.95007413 0.01448156] -12020.620976277785
[0.95012834 0.01481778] -9797.178529001847
[0.9503374  0.01431303] -9797.206051159888
[0.95044583 0.01498547] -9797.198551479982
[0.95041873 0.01481736] -9797.162782116835
[0.94989217 0.01515441] -9797.204929996955
[0.95046421 0.01464915] -9797.175760893633
[0.9507546  0.01464873] -9797.19090498117
[0.95028491 0.01477552] -9797.183458647147
[0.95044147 0.01473325] -9797.174785418438
[0.95027353 0.01481757] -9797.184286338323
[0.95058666 0.01473305] -9797.187168557768
[0.95035182 0.01479644] -9797.184722634074
[0.9504301  0.01477531] -9797.186913272346
[0.95034613 0.01481747] -9797.185365427142
[0.95033476 0.01485952] -9797.18716562303
[0.95040626 0.01479636] -9797.185263951993
[0.95047886 0.01479626] -9797.18648117203
[0.95037931 0.01481216] -9797.18533592402
[0.95044568 0.01480156] -9797.185275653306
[0.95042909 0.01480421] -9797.182145496716
[0.95044155 0.01482521] -9797.187132153244
[0.95041508 0.01480357] -9797.185755792845
[0.95042391 0.01481079] -9797.18017913526
[0.95041249 0.01480686] -9797.185837484132
[0.95043014 0.01482129] -19578.25402187223
[0.95041691 0.01481047] -9797.186008913119
[0.95042132 0.01481407] -9797.18725685019
[0.95041561 0.01481211] -9797.186107862466
[0.95041302 0.0148154 ] -9797.186222943114
[0.95041509 0.01481507] -9797.186223933857
[0.95041717 0.01481474] -9797.186183256294
[0.95042002 0.01481572] -9797.171789697957
[0.95042158 0.01481834] -9797.186471023293
[0.95041827 0.01481564] -9797.186310308121
[0.95041937 0.01481654] -9797.18560768965
[0.95041795 0.01481605] -9797.186311772113
[0.95042015 0.01481785] -9797.185826153911
[0.9504196 0.0148174] -9797.186397239057
[0.95041905 0.01481695] -9797.186368949253
[0.95041834 0.01481671] -9797.18631989819
[0.95041801 0.01481712] -19754.728087976044
[0.95041879 0.01481699] -9797.186247986394
[0.95041918 0.01481765] -9797.186401340858
[0.95041855 0.01481694] -19221.17264641688
[0.95041876 0.01481718] -9797.186361278753
[0.95041853 0.01481703] -19829.721915729326
[0.95041895 0.0148175 ] -9797.18641985684
[0.95041885 0.01481739] -9797.17712323689
[0.95041882 0.01481757] -9797.186438438212
[0.95041877 0.01481728] -9797.186364135638
[0.95041879 0.01481737] -9797.186382897407
[0.95041874 0.01481727] -9797.191502841357
[0.95041877 0.01481747] -9797.183834149198
[0.95041871 0.01481745] -9797.185280327696
[0.95041873 0.01481743] -9797.186138831887
[0.95041875 0.01481741] -19239.592119203437
[0.95041876 0.01481737] -9797.184113352549
[0.95041873 0.01481732] -9797.186151381899
[0.95041874 0.01481734] -9797.186461250396
[0.95041874 0.01481736] -9797.185873458802
[0.95041874 0.01481739] -9797.186382183738
[0.95041873 0.01481734] -9797.186380204746
[0.95041873 0.01481735] -9797.184858111452
[0.95041872 0.01481735] -9797.186572111956
[0.95041874 0.01481736] -9797.18638138027
[0.95041873 0.01481736] -9797.186381033684
[0.95041873 0.01481736] -9797.18631817414
[0.95041873 0.01481737] -9797.1863815942
[0.95041873 0.01481736] -9797.154897855242
[0.95041872 0.01481736] -9797.188792907162
[0.95041873 0.01481736] -9797.180868058125
[0.95041873 0.01481736] -19532.977422164997
[0.95041873 0.01481736] -9797.185373189805
[0.95041873 0.01481736] -9797.186381693986
[0.95041873 0.01481736] -9797.186381208761
[0.95041873 0.01481736] -9797.185335014707
[0.95041873 0.01481736] -9797.190769246377
[0.95041873 0.01481736] -19385.36531287924
[0.95041873 0.01481736] -19855.971112791194
[0.95041873 0.01481736] -9797.210035372678
[0.95041873 0.01481736] -9797.18645196222
[0.95041873 0.01481736] -9797.186361977074
[0.95041873 0.01481736] -9797.186381098305
[0.95041873 0.01481736] -9797.186205389746
[0.95041873 0.01481736] -9797.186535681994
[0.95041873 0.01481736] -9797.188012781158
[0.95041873 0.01481736] -9797.186642229732
[0.95041873 0.01481736] -9797.186365922475
[0.95041873 0.01481736] -9797.18371770112
[0.95041873 0.01481736] -9797.124160034566
[0.95041873 0.01481736] -9797.186381314423
[0.95041873 0.01481736] -9797.171833313172
[0.95041873 0.01481736] -9797.186381131327
[0.95041873 0.01481736] -9797.186381245863
[0.95041873 0.01481736] -9797.186381103711
[0.95041873 0.01481736] -9797.186370136638
[0.95041873 0.01481736] -9797.173177933475
[0.95041873 0.01481736] -9797.186381120133
[0.95041873 0.01481736] -9797.185882573114
[0.95041873 0.01481736] -9797.18638130373
[0.95041873 0.01481736] -9797.186381083253
[0.95041873 0.01481736] -9797.186381182355
[0.95041873 0.01481736] -9797.186381393003
[0.95041873 0.01481736] -9797.186378631292
[0.95041873 0.01481736] -9797.185689631711
[0.95041873 0.01481736] -9797.178534378683
[0.95041873 0.01481736] -9797.186381150217
[0.95041873 0.01481736] -9797.18615906726
[0.95041873 0.01481736] -9797.188583397026
[0.95041873 0.01481736] -9797.17500596976
[0.95041873 0.01481736] -9797.18551478059
[0.95041873 0.01481736] -9797.186373521723
[0.95041873 0.01481736] -9797.186360205538
[0.95041873 0.01481736] -9797.186367477254
[0.95041873 0.01481736] -9797.185499555357
[0.95041873 0.01481736] -9797.184887801079
[0.95041873 0.01481736] -9797.186241620095
[0.95041873 0.01481736] -9797.1863658075
[0.95041873 0.01481736] -9797.178764529246
[0.95041873 0.01481736] -19453.947360704562
[0.95041873 0.01481736] -9797.185984496853
[0.95041873 0.01481736] -9797.182128351804
[0.95041873 0.01481736] -9797.186381935384
[0.95041873 0.01481736] -9797.186359301308
[0.95041873 0.01481736] -9797.186078070927
[0.95041873 0.01481736] -9797.185973411128
[0.95041873 0.01481736] -9797.186383842134
[0.95041873 0.01481736] -9797.186381117735
[0.95041873 0.01481736] -9797.186381150623
[0.95041873 0.01481736] -9797.186378416343
[0.95041873 0.01481736] -9797.186381110118
[0.95041873 0.01481736] -9797.186352435838
[0.95041873 0.01481736] -9797.186737748485
[0.95041873 0.01481736] -9797.18637387942
[0.95041873 0.01481736] -9797.186405240405
[0.95041873 0.01481736] -9797.186381115205
[0.95041873 0.01481736] -9797.18641874826
[0.95041873 0.01481736] -9797.186177174723
[0.95041873 0.01481736] -9797.185893626469
[0.95041873 0.01481736] -14326.10523326229
[0.95041873 0.01481736] -9797.186214438805
[0.95041873 0.01481736] -9797.186356814454
[0.95041873 0.01481736] -9797.185013803166
[0.95041873 0.01481736] -19414.742945791073
[0.95041873 0.01481736] -9797.186587666249
[0.95041873 0.01481736] -9797.185012987307
[0.95041873 0.01481736] -9797.186360976235
[0.95041873 0.01481736] -9797.18638122861
[0.95041873 0.01481736] -9797.064653531661
[0.95041873 0.01481736] -9797.186297271312
[0.95041873 0.01481736] -9797.186378615972
[0.95041873 0.01481736] -9797.173500861085
[0.95041873 0.01481736] -9797.186378401342
[0.95041873 0.01481736] -9797.18638036718
[0.95041873 0.01481736] -9797.185725734696
[0.95041873 0.01481736] -9797.186432061848
[0.95041873 0.01481736] -9797.1863811367
[0.95041873 0.01481736] -9797.186508146768
[0.95041873 0.01481736] -16756.35499785158
[0.95041873 0.01481736] -9797.185523873184
[0.95041873 0.01481736] -9797.186282301318
[0.95041873 0.01481736] -9797.186381116135
[0.95041873 0.01481736] -9797.185765459139
[0.95041873 0.01481736] -9797.186381521913
[0.95041873 0.01481736] -9797.186343326095
[0.95041873 0.01481736] -9797.185886819923
[0.95041873 0.01481736] -9797.186313799357
[0.95041873 0.01481736] -9797.18638134168
[0.95041873 0.01481736] -9797.186477885038
[0.95041873 0.01481736] -9797.185957278374
[0.95041873 0.01481736] -9797.186341559478
[0.95041873 0.01481736] -9797.184206748143
[0.95041873 0.01481736] -9797.186336615378
[0.95041873 0.01481736] -9796.937339429584
[0.95041873 0.01481736] -9797.18627351132
[0.95041873 0.01481736] -9797.186381003146
[0.95041873 0.01481736] -9797.186339824108
[0.95041873 0.01481736] -9797.186287634247
[0.95041873 0.01481736] -9797.186376911448
[0.95041873 0.01481736] -9797.185958821912
[0.95041873 0.01481736] -9797.186151603757
[0.95041873 0.01481736] -9797.186380403982
[0.95041873 0.01481736] -9797.186304828461
[0.95041873 0.01481736] -9797.185632958646
[0.95041873 0.01481736] -9797.186304828461
[0.95041873 0.01481736] -9797.186304828461
[0.95041873 0.01481736] -9797.186304828461
[0.95041873 0.01481736] -9797.186369792269
[0.95041873 0.01481736] -9797.186369792269
[0.95041873 0.01481736] -9797.186369792269
[0.95041873 0.01481736] -9797.186369792269
[0.95041873 0.01481736] -9797.186379624995
[0.95041873 0.01481736] -9797.186379624995
[0.95041873 0.01481736] -9797.186379624995
[0.95041873 0.01481736] -9797.186379624995
[0.95041873 0.01481736] -9797.164535764932
[0.95041873 0.01481736] -9797.186324708358
[0.95041873 0.01481736] -9797.186283524743
[0.95041873 0.01481736] -9797.18628358322
[0.95041873 0.01481736] -9797.18626896697
[0.95041873 0.01481736] -9797.18638118382
[0.95041873 0.01481736] -9797.191441619108
[0.95041873 0.01481736] -9797.186835009157
[0.95041873 0.01481736] -9797.186277820936
[0.95041873 0.01481736] -9797.185677900006
[0.95041873 0.01481736] -9797.186365111753
[0.95041873 0.01481736] -9797.186401965291
[0.95041873 0.01481736] -9797.186426330267
[0.95041873 0.01481736] -9796.937339429584
[0.95041873 0.01481736] -9797.185560900458
[0.95041873 0.01481736] -9797.18626896697
[0.95041873 0.01481736] -9796.937339429584
[0.95041873 0.01481736] -9797.186283524743
[0.95041873 0.01481736] -9797.18626896697
[0.95041873 0.01481736] -9797.18626896697
[0.95041873 0.01481736] -9797.186283524743
[0.95041873 0.01481736] -9797.186277820936
[0.95041873 0.01481736] -9796.937339429584
[0.95041873 0.01481736] -9797.186277820936
[0.95041873 0.01481736] -9797.186401965291
[0.95041873 0.01481736] -9796.937339429584
theta 2:
 [0.95041873 0.01481736]
dynamic process:
 [0.04465452 0.33344375 0.58443309 0.17276607 0.76440883 0.06190494]
[9.  0.5 1. ] -404.90590863341566
[9.00000001 0.5        1.        ] -404.9059086310782
[9.         0.50000001 1.        ] -404.90590870142205
[9.         0.5        1.00000001] -404.9059084753607
[9.15686417e+00 9.99999997e-07 1.16068878e+01] -3273.979057948044
[9.01568642 0.4500001  2.06068878] -444.84350014908307
[9.0017513  0.49441779 1.11842002] -404.7370534782941
[9.00175132 0.49441779 1.11842002] -404.73705340968047
[9.0017513  0.4944178  1.11842002] -404.7370535945028
[9.0017513  0.49441779 1.11842003] -404.7370535966835
[1.17274949e+01 9.99999956e-07 1.80838509e+00] -411.09295556417476
[9.863358   0.3381328  1.33651776] -402.95213664314895
[9.86335801 0.3381328  1.33651776] -402.9521366231605
[9.863358   0.33813281 1.33651776] -402.95213665770984
[9.863358   0.3381328  1.33651778] -402.95213672416867
[10.20398192  0.47711926  1.3527785 ] -403.5228146328162
[9.91268743 0.35826093 1.33887265] -402.8576931442342
[9.91268744 0.35826093 1.33887265] -402.857693138453
[9.91268743 0.35826094 1.33887265] -402.8576931480025
[9.91268743 0.35826093 1.33887267] -402.857693167035
[10.00801476  0.39718401  1.35224657] -403.09609501900076
[9.92222016 0.36215324 1.34021005] -402.86136819073783
[9.9136407  0.35865016 1.33900639] -402.858021601426
[9.91278276 0.35829985 1.33888603] -402.8576864835935
[9.91278277 0.35829985 1.33888603] -402.8576864778151
[9.91278276 0.35829987 1.33888603] -402.8576864873702
[9.91278276 0.35829985 1.33888604] -402.8576865063895
[9.93223981 0.36307114 1.3378705 ] -402.8614980390665
[9.91934224 0.35990838 1.33854367] -402.8569636154107
[9.91934226 0.35990838 1.33854367] -402.85696361173825
[9.91934224 0.35990839 1.33854367] -402.8569636173752
[9.91934224 0.35990838 1.33854368] -402.85696362977865
[9.93942006 0.36729211 1.33890613] -402.8717539879196
[9.92135002 0.36064675 1.33857991] -402.8566144677741
[9.92135004 0.36064675 1.33857991] -402.85661446430447
[9.92135002 0.36064677 1.33857991] -402.8566144697623
[9.92135002 0.36064675 1.33857993] -402.8566144814269
[9.93911653 0.36632346 1.3368105 ] -402.8649293184101
[9.92468609 0.36171268 1.33824766] -402.85742366487136
[9.92224595 0.36093302 1.33849068] -402.8579516621549
[9.92143962 0.36067538 1.33857099] -402.8581453397333
[9.92135898 0.36064961 1.33857902] -402.85816523231097
[9.92135092 0.36064704 1.33857982] -402.85661421561895

minize() 

brute

reward process:
      fun: 402.85661421561895
     jac: array([-0.23284149,  0.13342667,  0.91622543])
 message: 'Optimization terminated successfully'
    nfev: 43
     nit: 7
    njev: 7
  status: 0
 success: True
       x: array([9.92135092, 0.36064704, 1.33857982])
time: 11165.942077875137

estimation1.loglike(parameters = [9.243,0.226,1.164],p0=estimation1.fitted2.x[0:3],p1 = estimation1.fitted2.x[3:6],theta2=estimation1.fitted_full)
[9.243, 0.226, 1.164] -403.3565142360588
Out[24]: 403.3565142360588








[0.039      0.333      0.83854293 0.181      0.757      0.58999999
 0.949      0.012     ]
[0.001      0.15945707 0.58680773 0.001      0.38229291 0.061
 0.949      0.012     ]